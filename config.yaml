train:
  seed: 1
  torch_deterministic: True
  device: cuda
  # total_timesteps: 800_000_000 # superceded by pokemon_red package
  learning_rate: 0.00025 # 0.00025
  # num_steps: 128 # 128
  anneal_lr: True
  gamma: 0.998 # 0.998 # 0.99 #BET testing 2/6/24
  gae_lambda: 0.95
  num_minibatches: 4 # 4
  # update_epochs: 10 # 2 # 3 # superceded by pokemon_red package
  norm_adv: True
  clip_coef: 0.1 # 0.1
  clip_vloss: True
  ent_coef: 0.01
  vf_coef: 0.5
  max_grad_norm: 0.5
  target_kl: ~

  # num_envs: 512 # 128 # 48  # superceded by pokemon_red package
  # envs_per_worker: 8 # 4  # superceded by pokemon_red package
  # envs_per_batch: 48 # must be <= num_envs  # superceded by pokemon_red package
  env_pool: True  
  verbose: True 
  data_dir: experiments
  checkpoint_interval: 200
  cpu_offload: True
  pool_kernel: [0]
  # batch_size: 65280 # 32768 # 128 (?) # superceded by pokemon_red package
  # batch_rows: 1024 # 256 # 128 # superceded by pokemon_red package
  bptt_horizon: 16 # 32 # 16
  vf_clip_coef: 0.1 # 0.12 # 0.1
  compile: True
  compile_mode: reduce-overhead

sweep:
  method: random
  name: sweep
  metric:
    goal: maximize
    name: episodic_return
  # Nested parameters name required by WandB API
  parameters:
    train:
      parameters:
        learning_rate: {
          'distribution': 'log_uniform_values',
          'min': 1e-4,
          'max': 1e-1,
        }
        batch_size: {
          'values': [128, 256, 512, 1024, 2048],
        }
        batch_rows: {
          'values': [16, 32, 64, 128, 256],
        }
        bptt_horizon: {
          'values': [4, 8, 16, 32],
        }

pokemon_red:
  package: pokemon_red
  train:
    total_timesteps: 500_000_000
    num_envs: 150 # 150
    envs_per_worker: 1 # 1 (next, try 6)
    # envpool_batch_size: 128
    envs_per_batch: 12 # 32 # 60  # env_per_batch / envs_per_worker ~ (# thread -2)  and set num_envs ~ 2.5 * env_per_batch
    update_epochs: 3
    gamma: 0.998
    batch_size: 65536 # 32768
    batch_rows: 128
  env:
    name: pokemon_red
pokemon-red:
  package: pokemon_red
pokemonred:
  package: pokemon_red
pokemon:
  package: pokemon_red
pokegym:
  package: pokemon_red
 